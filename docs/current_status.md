## 現在の進捗概要

- **ライフサイクル管理**
  - `GameState` に `lifecycleStage` (`lobby`/`characterSelect`/`inGame`) を追加。ルーム作成時は `lobby` で開始し、ホストが「キャラクター選択を開始」を押すと `characterSelect` へ、ゲーム開始で `inGame` へ遷移。
  - Functions に `beginCharacterSelection` と `startGame` を追加して前述のステージ遷移をサーバー側で制御。

- **キャラクター選択**
  - `/character-select` ページで全プレイヤーがキャラを選択可能。重複のみ禁止であれば再選択も許容。
  - ホストのみ全員選択済みかつ `lifecycleStage === 'characterSelect'` のとき `startGame` を押してメインフェーズへ進める。
  - `PhaseNavigator` により、`lifecycleStage` の変化に応じて全クライアントが自動的に `/character-select` や `/play` へリダイレクトされる。

- **メインボード (`/play`)**
  - ルーム／フェーズ情報、プレイヤー一覧（ホスト/ローカル/キャラ表示付）、共有ボードのサマリー、`pass` アクションボタンを実装。
  - UI はデバッグ用の骨組みで、他アクションや詳細ボード表示は未実装。

- **自動更新**
  - 接続中は 5 秒ごとにサイレントで `GameState` を再取得し、キャラクター選択状況等が自動反映される。

- **テスト**
  - RoomService の新機能（ステージ遷移/再選択）に対するテストを追加。
  - `npm test -- --run` と `npx tsc --noEmit` を実行済み。

## 次の検討項目

1. **メインボード UI の肉付け**
   - ボードレイアウト、開発カードやレンズの詳細表示、各アクション操作のフォームやボタン配置を設計する。
   - イベントログやリソース推移など、プレイ中に必要な情報の表示範囲を決定。

2. **フェーズ遷移フローの拡張**
   - メインフェーズから終了フェーズ／最終得点フェーズへの遷移操作（ホストトリガーや自動判定）を UI に組み込む。

3. **認証・権限管理**
   - Firebase Authentication とセキュリティルールで、ホスト権限や本人確認を厳密にする。

4. **リアルタイム性の強化**
   - 将来的には onSnapshot などを利用した即時同期を検討し、ポーリング間隔の短縮やリスナー化を進める。

